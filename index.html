<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title id='title'>Toy Building App</title>

		<!--CSS-->
		<link rel="stylesheet" type="text/css" href="styles.css" />

		<!--Javascript-->
		<script type="text/javascript" src="components/module.js" ></script>
		<script type="text/javascript" src="components/manager.js" ></script>
		<script type="text/javascript" src="components/sprite.js" ></script>
		<script type="text/javascript" src="components/characterSkeleton.js" ></script>
		<script type="text/javascript" src="components/playArea.js" ></script>
		<script type="text/javascript" src="components/toybox.js" ></script>
		<script type="text/javascript" src="components/toyboxTab.js" ></script>
		<!--Extensions-->
		<script type="text/javascript" src="extensions/touch.js" ></script>
	
		<script>

			var canvas, ctx, manager, playArea;
			function onLoad(){
				//Grab the Canvas.
				canvas = document.getElementById("main");
				ctx = canvas.getContext("2d");
				//Make the canvas full screen
				document.getElementById("main").style.height="100%";
				document.getElementById("main").style.width="100%";
				//create and add elements
				manager = Manager();
				playArea = PlayArea(0,0,2*window.innerWidth/3,window.innerHeight);
				toybox = ToyBox(2*window.innerWidth/3,0,window.innerWidth/3,window.innerHeight);
				manager.init(canvas, ctx);
				

				manager.setLoad(function(){
					manager.draw();
				});
				
				//The two main areas of our app inside of the canvas.
				manager.addModule(playArea);
				manager.addModule(toybox);
				
				//create objects
				//Toybox tabs.
				var tab1 = ToyBoxTab(0, 128, toybox.bounds.width, toybox.bounds.height - 128, "head");
					//Components in side of a tab
					tab1.addOption(Sprite(0, 0, 128, 128, "images/Esther sets/Esther-1/esther-set-1-02.png"), "images/Esther sets/Esther-1/esther-set-1-02.png");
					tab1.addOption(Sprite(128, 0, 128, 128, "images/Esther sets/Esther-2/esther-set-2-02.png"), "images/Esther sets/Esther-2/esther-set-2-02.png");
					tab1.addOption(Sprite(0, 128, 128, 128, "images/Esther sets/Esther-3/esther-set-3-02.png"), "images/Esther sets/Esther-3/esther-set-3-02.png");
					tab1.addOption(Sprite(128, 128, 128, 128, "images/dev/_04.png"), Sprite(0, 0, 230, 230, "images/dev/_04.png"));
					//add the tab to the toybox
					toybox.addModule(tab1);
				var tab2 = ToyBoxTab(0, 128, toybox.bounds.width, toybox.bounds.height - 128, "body");
					tab2.addOption(Sprite(0, 0, 128, 128, "images/Esther sets/Esther-1/esther-set-1-03.png"), "images/Esther sets/Esther-1/esther-set-1-03.png");
					tab2.addOption(Sprite(128, 0, 128, 128, "images/Esther sets/Esther-2/esther-set-2-03.png"), "images/Esther sets/Esther-2/esther-set-2-03.png");
					tab2.addOption(Sprite(0, 128, 128, 128, "images/dev/_05.png"), "images/dev/_05.png");
					tab2.addOption(Sprite(128, 128, 128, 128, "images/dev/_06.png"), "images/dev/_06.png");
					toybox.addModule(tab2);
				var tab3 = ToyBoxTab(0, 128, toybox.bounds.width, toybox.bounds.height - 128, "feet");
					tab3.addOption(Sprite(0, 0, 128, 128, "images/Esther sets/Esther-1/esther-set-1-04.png"), "images/Esther sets/Esther-1/esther-set-1-04.png");
					tab3.addOption(Sprite(128, 0, 128, 128, "images/Esther sets/Esther-2/esther-set-2-04.png"), "images/Esther sets/Esther-2/esther-set-2-04.png");
					tab3.addOption(Sprite(0, 128, 128, 128, "images/dev/_07.png"), "images/dev/_07.png");
					tab3.addOption(Sprite(128, 128, 128, 128, "images/dev/_08.png"), "images/dev/_08.png");
					toybox.addModule(tab3);
				
				//TEMP DEV TABS
				var devTab1 = Sprite(0, 0, 128, 128, "images/dev/tab1.png");
				var devTab2 = Sprite(128, 0, 128, 128, "images/dev/tab2.png");
				var devTab3 = Sprite(256, 0, 128, 128, "images/dev/tab3.png");
				
				//TEMP DEV TOY TEST
				// ADD MODULES
					var toy = CharacterSkeleton(200, 150, 234, 400);
					//visual test of character skeleton
					playArea.addModule(toy);
					//TEMP DEV SPRITE SET UP FOR TOY
					toy.setSlot("head", Sprite());
					toy.setSlot("body", Sprite());
					toy.setSlot("feet", Sprite());
					//specific to toybox -- TEMP DEV
					toybox.addModule(devTab1);
					toybox.addModule(devTab2);
					toybox.addModule(devTab3);
					toybox.addModule(tab1);
					toybox.addModule(tab2);
					toybox.addModule(tab3);

				//DEV adding events
				devTab1.addEvent("mousedown", function(_clipBoard){ 
					tab1.select();
					tab2.deselect();
					tab3.deselect();
					//ToDo: This next line isn't working.
					if(_clipBoard.ToFire) { _clipBoard.ToFire.push("redraw"); } else { _clipBoard.ToFire = ["redraw"]; }
					//work.
					//manager.draw();
				}, true);
				devTab2.addEvent("mousedown", function(_clipBoard){ 
					if(_clipBoard.ToFire) { _clipBoard.ToFire.push("redraw"); } else { _clipBoard.ToFire = ["redraw"]; }
					tab1.deselect();
					tab2.select();
					tab3.deselect();
					//manager.draw();
				}, false);
				devTab3.addEvent("mousedown", function(_clipBoard){ 
					if(_clipBoard.ToFire) { _clipBoard.ToFire.push("redraw"); } else { _clipBoard.ToFire = ["redraw"]; }
					tab1.deselect();
					tab2.deselect();
					tab3.select();
					manager.draw();
				}, false);

				// dev1.addEvent("mousedown", function(_clipBoard){
				// 	_clipBoard.ToFire = ["swapComponent"];
				// 	_clipBoard.Body = {"image":"images/dev/_01.png", "slot":"body"}
				// }, false);

				// dev3.addEvent("mousedown", function(_clipBoard){
				// 	_clipBoard.ToFire = ["swapComponent"];
				// 	_clipBoard.Body = {"image":"images/dev/_03.png", "slot":"body"}
				// }, false);

				// dev2.addEvent("mousedown", function(_clipBoard){
				// 	_clipBoard.ToFire = ["swapComponent"];
				// 	_clipBoard.Body = {"image":"images/dev/_02.png", "slot":"head"}
				// }, false);

				// dev4.addEvent("mousedown", function(_clipBoard){
				// 	_clipBoard.ToFire = ["swapComponent"];
				// 	_clipBoard.Body = {"image":"images/dev/_04.png", "slot":"head"}
				// }, false);

				toybox.addEvent("changeTab", function(_clipBoard){ alert("change to tab: " + _clipBoard.tabChange.source); }, false);
				toy.addEvent("swapComponent", function(_clipBoard){ toy.setSlot(_clipBoard.ComponentSwap.slot, _clipBoard.ComponentSwap.image); }, false);
				//\toy.addEvent("mouseup", function(_clipBoard){ alert("hi, I'm Esther!"); }, false);
			}
		window.onload = onLoad;
		</script>
	</head>



	<!--Main app-->
	<body>
		<!--Canvas is width and height of the screen.-->
		<!--We'll need to set this stuff up so it goes full screen I guess.-->
		
		<!--I don't really understand how the width and height is functioning 
		below on the canvas in line style. It seems to be acting as a resolution 
		for the canvas. Not sure if canvas properties itself, or 
		Possibly due to the fact that the canvas was made full screen 
		by the "onLoad" script at the top of this page.-->
		<canvas id="main" width="1920px" height="1080px"></canvas>
	</body>

</html>